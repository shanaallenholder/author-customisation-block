"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useCopyHandler = useCopyHandler;

var _compose = require("@wordpress/compose");

var _toHtmlString = require("../to-html-string");

var _isCollapsed = require("../is-collapsed");

var _slice = require("../slice");

var _getTextContent = require("../get-text-content");

/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */
function useCopyHandler(_ref) {
  var record = _ref.record,
      multilineTag = _ref.multilineTag,
      preserveWhiteSpace = _ref.preserveWhiteSpace;
  return (0, _compose.useRefEffect)(function (element) {
    function onCopy(event) {
      if ((0, _isCollapsed.isCollapsed)(record.current) || !element.contains(element.ownerDocument.activeElement)) {
        return;
      }

      var selectedRecord = (0, _slice.slice)(record.current);
      var plainText = (0, _getTextContent.getTextContent)(selectedRecord);
      var html = (0, _toHtmlString.toHTMLString)({
        value: selectedRecord,
        multilineTag: multilineTag,
        preserveWhiteSpace: preserveWhiteSpace
      });
      event.clipboardData.setData('text/plain', plainText);
      event.clipboardData.setData('text/html', html);
      event.clipboardData.setData('rich-text', 'true');
      event.preventDefault();
    }

    element.addEventListener('copy', onCopy);
    return function () {
      element.removeEventListener('copy', onCopy);
    };
  }, [record, multilineTag, preserveWhiteSpace]);
}
//# sourceMappingURL=use-copy-handler.js.map